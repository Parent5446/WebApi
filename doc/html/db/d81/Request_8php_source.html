<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WebApi: app/out/Request.php Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="../../globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="../../dir_a261379d24894f08009c147cca3fa917.html">app</a>&nbsp;&raquo&nbsp;<a class="el" href="../../dir_eb96bd936c2dacad4ca5f311d3036ee6.html">out</a>
  </div>
</div>
<div class="contents">
<h1>Request.php</h1><a href="../../db/d81/Request_8php.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 &lt;?php
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="keywordflow">if</span>(!defined(<span class="stringliteral">&quot;API&quot;</span>)) { <span class="keywordflow">return</span> <span class="keyword">false</span>; }
<a name="l00004"></a>00004 
<a name="l00037"></a><a class="code" href="../../de/d53/classOUT__Request.html">00037</a> <span class="keyword">class </span><a class="code" href="../../de/d53/classOUT__Request.html">OUT_Request</a>
<a name="l00038"></a>00038 {
<a name="l00043"></a><a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">00043</a>         <span class="keyword">protected</span> <a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a>;
<a name="l00044"></a>00044 
<a name="l00049"></a><a class="code" href="../../de/d53/classOUT__Request.html#ae2aa3cf43543978530ee50af4433f954">00049</a>         <span class="keyword">protected</span> <a class="code" href="../../de/d53/classOUT__Request.html#ae2aa3cf43543978530ee50af4433f954">$db</a>;
<a name="l00050"></a>00050 
<a name="l00056"></a><a class="code" href="../../de/d53/classOUT__Request.html#a749906f7ca9aeb506814d71f0215e380">00056</a>         <span class="keyword">public</span> function <a class="code" href="../../de/d53/classOUT__Request.html#a749906f7ca9aeb506814d71f0215e380">__construct</a>(&amp;<a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a>, &amp;<a class="code" href="../../de/d53/classOUT__Request.html#ae2aa3cf43543978530ee50af4433f954">$db</a>, &amp;$session) {
<a name="l00057"></a>00057                 <span class="keywordflow">if</span>(!<a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a>  instanceof <a class="code" href="../../dc/d96/classMAIN__Config.html">MAIN_Config</a> ||
<a name="l00058"></a>00058                    !<a class="code" href="../../de/d53/classOUT__Request.html#ae2aa3cf43543978530ee50af4433f954">$db</a>      instanceof <a class="code" href="../../d3/d63/classDB__Database.html">DB_Database</a>   ) {
<a name="l00059"></a>00059                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00060"></a>00060                 }
<a name="l00061"></a>00061                 $this-&gt;config  =&amp; <a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a>;
<a name="l00062"></a>00062                 $this-&gt;db      =&amp; <a class="code" href="../../de/d53/classOUT__Request.html#ae2aa3cf43543978530ee50af4433f954">$db</a>;
<a name="l00063"></a>00063         }
<a name="l00064"></a>00064 
<a name="l00069"></a><a class="code" href="../../de/d53/classOUT__Request.html#a825f77601714b2cb7510ab65d2d71483">00069</a>         <span class="keyword">public</span> function <a class="code" href="../../de/d53/classOUT__Request.html#a825f77601714b2cb7510ab65d2d71483">initiate</a>(&amp;$session) { }
<a name="l00070"></a>00070 
<a name="l00074"></a><a class="code" href="../../de/d53/classOUT__Request.html#acc60e320923329be1aa103406a4a3ee9">00074</a>         <span class="keyword">public</span> function <a class="code" href="../../de/d53/classOUT__Request.html#acc60e320923329be1aa103406a4a3ee9">send</a>() {
<a name="l00075"></a>00075                 $html = $this-&gt;<span class="keyword">template</span>-&gt;execute();
<a name="l00076"></a>00076                 echo <a class="code" href="../../de/d53/classOUT__Request.html#a7106b7d90946eacf1688d089c12722f0">self::tidy</a>($html);
<a name="l00077"></a>00077         }
<a name="l00078"></a>00078 
<a name="l00086"></a><a class="code" href="../../de/d53/classOUT__Request.html#aaa4a74668b18665c9408f57dd0556f98">00086</a>         <span class="keyword">public</span> function <a class="code" href="../../de/d53/classOUT__Request.html#aaa4a74668b18665c9408f57dd0556f98">getOption</a>($option) {
<a name="l00087"></a>00087                 <span class="keywordflow">return</span> $this-&gt;<span class="keyword">template</span> instanceof <a class="code" href="../../d0/dcf/classOUT__Template.html">OUT_Template</a> ?
<a name="l00088"></a>00088                             $this-&gt;<span class="keyword">template</span>-&gt;getOption($option) :
<a name="l00089"></a>00089                             <span class="keyword">false</span>;
<a name="l00090"></a>00090         }
<a name="l00091"></a>00091 
<a name="l00100"></a><a class="code" href="../../de/d53/classOUT__Request.html#ad1b829ea37ed35c67115e0886089d92d">00100</a>         <span class="keyword">public</span> function <a class="code" href="../../de/d53/classOUT__Request.html#ad1b829ea37ed35c67115e0886089d92d">putOption</a>($option, $value) {
<a name="l00101"></a>00101                 <span class="keywordflow">return</span> $this-&gt;<span class="keyword">template</span> instanceof <a class="code" href="../../d0/dcf/classOUT__Template.html">OUT_Template</a> ?
<a name="l00102"></a>00102                             $this-&gt;<span class="keyword">template</span>-&gt;putOption($option, $value) :
<a name="l00103"></a>00103                             <span class="keyword">false</span>;
<a name="l00104"></a>00104         }
<a name="l00105"></a>00105 
<a name="l00113"></a><a class="code" href="../../de/d53/classOUT__Request.html#a2b3032d9a81143c98702d8b9344e6ba2">00113</a>         <span class="keyword">protected</span> function <a class="code" href="../../de/d53/classOUT__Request.html#a2b3032d9a81143c98702d8b9344e6ba2">getTemplate</a>() {
<a name="l00114"></a>00114                 global $rootdir;
<a name="l00115"></a>00115                 $paths        = $this-&gt;config-&gt;getOption(<span class="stringliteral">&apos;paths&apos;</span>);
<a name="l00116"></a>00116                 $dirname      = isset($paths[<span class="stringliteral">&apos;templates&apos;</span>]) ? $paths[<span class="stringliteral">&apos;templates&apos;</span>] : <span class="stringliteral">&quot;$rootdir/templates&quot;</span>;
<a name="l00117"></a>00117                 $templatename = strtolower(get_class($this));
<a name="l00118"></a>00118                 $template     = <span class="keyword">new</span> <a class="code" href="../../d0/dcf/classOUT__Template.html">OUT_Template</a>(<span class="stringliteral">&quot;$dirname/$templatename.template&quot;</span>);
<a name="l00119"></a>00119 
<a name="l00120"></a>00120                 <span class="keywordflow">if</span>($template === <span class="keyword">false</span>) {
<a name="l00121"></a>00121                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00122"></a>00122                 } <span class="keywordflow">else</span> {
<a name="l00123"></a>00123                         $this-&gt;<span class="keyword">template</span> = $template;
<a name="l00124"></a>00124                 } <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00125"></a>00125         }
<a name="l00126"></a>00126 
<a name="l00136"></a><a class="code" href="../../de/d53/classOUT__Request.html#a9b012befff9ae7c85396d42989067d83">00136</a>         <span class="keyword">private</span> function <a class="code" href="../../de/d53/classOUT__Request.html#a9b012befff9ae7c85396d42989067d83">storeUploadedFile</a>($source, $name) {
<a name="l00137"></a>00137                 <span class="keywordflow">if</span>(!is_uploaded_file($_FILES[$source][<span class="stringliteral">&apos;tmp_name&apos;</span>])) {
<a name="l00138"></a>00138                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00139"></a>00139                 }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141                 $paths       = $this-&gt;config-&gt;getOption(<span class="stringliteral">&apos;paths&apos;</span>);
<a name="l00142"></a>00142                 $uploaddir   = isset($paths[<span class="stringliteral">&apos;uploads&apos;</span>]) ? $paths[<span class="stringliteral">&apos;uploads&apos;</span>] : <span class="stringliteral">&quot;$rootdir/uploads&quot;</span>;
<a name="l00143"></a>00143                 $destination = $uploaddir . <span class="charliteral">&apos;/&apos;</span> . addslashes($name);
<a name="l00144"></a>00144                 <span class="keywordflow">if</span> (move_uploaded_file($_FILES[$source][<span class="stringliteral">&apos;tmp_name&apos;</span>], $destination)) {
<a name="l00145"></a>00145                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00146"></a>00146                 } <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00147"></a>00147         }
<a name="l00148"></a>00148 
<a name="l00157"></a><a class="code" href="../../de/d53/classOUT__Request.html#a7106b7d90946eacf1688d089c12722f0">00157</a>         <span class="keyword">private</span> <span class="keyword">static</span> function <a class="code" href="../../de/d53/classOUT__Request.html#a7106b7d90946eacf1688d089c12722f0">tidy</a>($html) {
<a name="l00158"></a>00158                 <a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a> = array(
<a name="l00159"></a>00159                         <span class="stringliteral">&apos;clean&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00160"></a>00160                         <span class="stringliteral">&apos;doctype&apos;</span> =&gt; <span class="stringliteral">&apos;strict&apos;</span>,
<a name="l00161"></a>00161                         <span class="stringliteral">&apos;drop-font-tags&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00162"></a>00162                         <span class="stringliteral">&apos;drop-proprietary-attributes&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00163"></a>00163                         <span class="stringliteral">&apos;enclose-block-text&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00164"></a>00164                         <span class="stringliteral">&apos;indent-cdata&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00165"></a>00165                         <span class="stringliteral">&apos;output-xhtml&apos;</span> =&gt; <span class="keyword">true</span>,
<a name="l00166"></a>00166                         <span class="stringliteral">&apos;accessibility-check&apos;</span> =&gt; 3,
<a name="l00167"></a>00167                         <span class="stringliteral">&apos;indent&apos;</span> =&gt; <span class="stringliteral">&apos;auto&apos;</span>,
<a name="l00168"></a>00168                         <span class="stringliteral">&apos;sort-attributes&apos;</span> =&gt; <span class="stringliteral">&apos;alpha&apos;</span> );
<a name="l00169"></a>00169                 $tidy = tidy_parse_string($html, <a class="code" href="../../de/d53/classOUT__Request.html#a628de0ecf0318ef0459d1b1986bf2586">$config</a>);
<a name="l00170"></a>00170                 $tidy-&gt;cleanRepair();
<a name="l00171"></a>00171                 <span class="keywordflow">return</span> $tidy;
<a name="l00172"></a>00172         }
<a name="l00173"></a>00173 }
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Thu Jan 28 21:25:45 2010 for WebApi by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
